---
phase: 02-layout-navigation
plan: 04
type: execute
wave: 2
depends_on: [02-02]
files_modified: [src/components/layout/Header/Navigation.tsx, src/components/layout/Header/index.ts, src/index.css, src/components/layout/Header/__tests__/Navigation.test.tsx]
autonomous: true

must_haves:
  truths:
    - "Navigation links display in header (desktop)"
    - "Clicking nav links smoothly scrolls to sections"
    - "Active section link is highlighted"
    - "Progress line appears under active link"
  artifacts:
    - path: "src/components/layout/Header/Navigation.tsx"
      provides: "Desktop navigation with active state highlighting"
      min_lines: 40
    - path: "src/index.css"
      provides: "Smooth scroll behavior and scroll padding"
      contains: "scroll-behavior"
  key_links:
    - from: "src/components/layout/Header/Navigation.tsx"
      to: "src/components/layout/Header/HeaderProvider.tsx"
      via: "useHeaderContext hook"
      pattern: "useHeaderContext"
    - from: "src/components/layout/Header/Navigation.tsx"
      to: "html element"
      via: "smooth scroll CSS"
      pattern: "scroll-behavior.*smooth"
---

<objective>
Create desktop navigation component with smooth scrolling and active section highlighting.

Purpose: Enables users to navigate between sections with visual feedback showing which section is currently in view and a progress indicator.

Output: Working Navigation sub-component with smooth scroll, active state tracking, and progress line indicator.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/02-layout-navigation/02-CONTEXT.md
@.planning/phases/02-layout-navigation/02-RESEARCH.md
@.planning/phases/02-layout-navigation/02-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Add smooth scroll CSS to index.css</name>
  <files>src/index.css</files>
  <action>
    Add smooth scroll behavior to html element:

    At the TOP of the file (before @theme), add:

    html {
      scroll-behavior: smooth;
      scroll-padding-top: 80px;
    }

    scroll-padding-top ensures section headers aren't hidden by fixed header.
    This uses native CSS smooth scrolling (per RESEARCH.md - zero runtime overhead).
  </action>
  <verify>grep -q "scroll-behavior: smooth" src/index.css</verify>
  <done>Smooth scroll behavior enabled via CSS</done>
</task>

<task type="auto">
  <name>Create Navigation.tsx with active state tracking</name>
  <files>src/components/layout/Header/Navigation.tsx</files>
  <action>
    Create desktop navigation component with Intersection Observer for active section:

    import type React from "react";
    import { useEffect, useState } from "react";
    import { motion } from "motion/react";
    import { useHeaderContext } from "./HeaderProvider";

    type Section = {
      id: string;
      label: string;
    };

    const sections: Section[] = [
      { id: "about", label: "About" },
      { id: "career", label: "Career" },
      { id: "skills", label: "Skills" },
      { id: "projects", label: "Projects" },
      { id: "contact", label: "Contact" },
    ];

    type NavigationProps = {
      className?: string;
    };

    export const Navigation: React.FC<NavigationProps> = ({ className = "" }) => {
      const [activeSection, setActiveSection] = useState("about");
      const [sectionProgress, setSectionProgress] = useState(0);

      useEffect(() => {
        const observers = sections.map((section) => {
          const element = document.getElementById(section.id);
          if (!element) return null;

          return new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  setActiveSection(section.id);
                }
              });
            },
            { threshold: 0.3 }
          );
        });

        const validObservers = observers.filter(Boolean) as IntersectionObserver[];

        validObservers.forEach((observer, index) => {
          const element = document.getElementById(sections[index]!.id);
          if (element) observer.observe(element);
        });

        // Track scroll progress within active section
        const handleScroll = () => {
          const activeElement = document.getElementById(activeSection);
          if (!activeElement) return;

          const rect = activeElement.getBoundingClientRect();
          const sectionHeight = activeElement.offsetHeight;
          const scrolled = -rect.top;
          const progress = Math.min(Math.max(scrolled / sectionHeight, 0), 1);
          setSectionProgress(progress);
        };

        window.addEventListener("scroll", handleScroll);

        return () => {
          validObservers.forEach((observer) => observer.disconnect());
          window.removeEventListener("scroll", handleScroll);
        };
      }, [activeSection]);

      const handleClick = (e: React.MouseEvent<HTMLAnchorElement>, id: string) => {
        e.preventDefault();
        const element = document.getElementById(id);
        if (element) {
          element.scrollIntoView({ behavior: "smooth" });
        }
      };

      return (
        <nav className={`hidden md:flex items-center gap-8 ${className}`}>
          {sections.map((section) => (
            <div key={section.id} className="relative group">
              <a
                href={`#${section.id}`}
                onClick={(e) => handleClick(e, section.id)}
                className={`text-sm font-medium transition-colors ${
                  activeSection === section.id
                    ? "text-foreground"
                    : "text-muted-foreground hover:text-foreground"
                }`}
              >
                {section.label}
              </a>
              {activeSection === section.id && (
                <motion.div
                  className="absolute -bottom-1 left-0 right-0 h-0.5 bg-primary"
                  initial={{ scaleX: 0 }}
                  animate={{ scaleX: sectionProgress }}
                  style={{ transformOrigin: "left" }}
                />
              )}
            </div>
          ))}
        </nav>
      );
    };

    Uses Intersection Observer (off main thread, per RESEARCH.md).
    Progress line fills as user scrolls through the active section.
    Links are text-only with hover effects (per CONTEXT.md).
  </action>
  <verify>file exists and uses IntersectionObserver for active tracking</verify>
  <done>Navigation component with active state and progress indicator created</done>
</task>

<task type="auto">
  <name>Update Header index.ts to include Navigation</name>
  <files>src/components/layout/Header/index.ts</files>
  <action>
    Update assembly file to attach Navigation as sub-component:

    import { Header } from "./Header";
    import { Logo } from "./Logo";
    import { Navigation } from "./Navigation";

    Header.Logo = Logo;
    Header.Navigation = Navigation;

    export { Header };
    export { useHeaderContext } from "./HeaderProvider";

    This enables usage: <Header><Header.Logo /><Header.Navigation /></Header>
  </action>
  <verify>grep -q "Header.Navigation" src/components/layout/Header/index.ts</verify>
  <done>Navigation attached to Header compound component</done>
</task>

<task type="auto">
  <name>Create test file for Navigation</name>
  <files>src/components/layout/Header/__tests__/Navigation.test.tsx</files>
  <action>
    Create test file following project conventions:

    import { render, screen } from "@testing-library/react";
    import { describe, expect, it, vi } from "vitest";
    import { HeaderProvider } from "../HeaderProvider";
    import { Navigation } from "../Navigation";

    describe("Navigation", () => {
      it("should render all navigation links", () => {
        render(
          <HeaderProvider>
            <Navigation />
          </HeaderProvider>
        );
        expect(screen.getByText("About")).toBeInTheDocument();
        expect(screen.getByText("Career")).toBeInTheDocument();
        expect(screen.getByText("Skills")).toBeInTheDocument();
        expect(screen.getByText("Projects")).toBeInTheDocument();
        expect(screen.getByText("Contact")).toBeInTheDocument();
      });

      it("should have correct href attributes", () => {
        render(
          <HeaderProvider>
            <Navigation />
          </HeaderProvider>
        );
        expect(screen.getByText("About").closest("a")).toHaveAttribute("href", "#about");
        expect(screen.getByText("Contact").closest("a")).toHaveAttribute("href", "#contact");
      });
    });

    Tests verify all links render with correct href attributes.
  </action>
  <verify>npm run test -- --run Navigation.test.tsx passes</verify>
  <done>Navigation tests created and passing</done>
</task>

</tasks>

<verification>
- npm run build completes without errors
- npm run lint passes
- npm run test -- --run passes for Navigation tests
- Navigation can be used as <Header.Navigation />
- Clicking nav links smooth scrolls to sections
- Active section link is visually highlighted
- Progress line appears and fills under active link
</verification>

<success_criteria>
Desktop navigation with smooth scrolling, active section highlighting, and progress indicator working. All tests passing.
</success_criteria>

<output>
After completion, create `.planning/phases/02-layout-navigation/02-04-SUMMARY.md`
</output>
